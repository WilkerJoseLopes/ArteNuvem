{% extends "base.html" %}
{% block title %}ArteNuvem{% endblock %}

{% block content %}
<div class="container">

    {# --- INÍCIO DA ATUALIZAÇÃO (Bloco inserido conforme atualizar.txt) --- #}
    {# logo do topo do index: título de pesquisa ou header de exposição #}
    {% if exposicao %}
      <section class="exposicao-header">
        <h1>{{ exposicao.nome }}</h1>
        {% if exposicao.descricao %}
          <p class="descricao">{{ exposicao.descricao }}</p>
        {% endif %}
        <p class="datas">
          {% if exposicao.mes_inteiro %}
            Período: {{ exposicao.mes }}
          {% else %}
            {% if exposicao.start_date %}{{ exposicao.start_date.strftime('%d %b %Y') }}{% endif %}
            —
            {% if exposicao.end_date %}{{ exposicao.end_date.strftime('%d %b %Y') }}{% endif %}
          {% endif %}
        </p>
        <hr>
      </section>
    {% elif query_text %}
      <section class="resultados-header">
        <h2>Resultados de "{{ query_text }}"</h2>
        <hr>
      </section>
    {% endif %}
    {# --- FIM DA ATUALIZAÇÃO --- #}

    {% if is_search %}
        <section class="section">
            <h2 class="section-title">
                Resultados{% if query_text %} de “{{ query_text }}”{% endif %}
            </h2>

            <div class="grid">
                {% for img in imagens %}
                    <div class="card">
                        <a href="{{ url_for('imagem_detalhe', imagem_id=img.id) }}">
                            <img src="{{ img.caminho_armazenamento }}" alt="{{ img.titulo }}" loading="lazy">
                        </a>
                        <div class="card-body">
                            <h3>{{ img.titulo }}</h3>
                            {% if img.categoria_texto %}
                                <span class="badge">{{ img.categoria_texto }}</span>
                            {% endif %}
                        </div>
                    </div>
                {% else %}
                    <p>Nenhum resultado encontrado.</p>
                {% endfor %}
            </div>
        </section>

    {% else %}

        <section class="section">
            <h2>Recomendações</h2>

            <div class="grid">
                {% for img in recomendacoes %}
                    <div class="card">
                        <a href="{{ url_for('imagem_detalhe', imagem_id=img.id) }}">
                            <img src="{{ img.caminho_armazenamento }}" alt="{{ img.titulo }}" loading="lazy">
                        </a>
                        <div class="card-body">
                            <h3>{{ img.titulo }}</h3>
                            {% if img.categoria_texto %}
                                <span class="badge">{{ img.categoria_texto }}</span>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        </section>

        <section class="section">
            <h2>Catálogo</h2>

            <div class="grid">
                {% for img in imagens %}
                    <div class="card">
                        <a href="{{ url_for('imagem_detalhe', imagem_id=img.id) }}">
                            <img src="{{ img.caminho_armazenamento }}" alt="{{ img.titulo }}" loading="lazy">
                        </a>
                        <div class="card-body">
                            <h3>{{ img.titulo }}</h3>
                            {% if img.categoria_texto %}
                                <span class="badge">{{ img.categoria_texto }}</span>
                            {% endif %}
                        </div>
                    </div>
                {% endfor %}
            </div>
        </section>

    {% endif %}

</div>
{% endblock %}
